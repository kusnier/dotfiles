#!/usr/bin/env bash
set -euo pipefail

error() {
  echo "❌ $1" >&2
  exit 1
}

command -v pandoc >/dev/null 2>&1 || error "pandoc nicht installiert!"
command -v wkhtmltopdf >/dev/null 2>&1 || error "wkhtmltopdf nicht installiert! (texlive-xetex)"

if [ $# -lt 1 ]; then
  error "Bitte eine Markdown-Datei angeben!"
fi

INPUT="$1"
[ -f "$INPUT" ] || error "Datei nicht gefunden: $INPUT"

BASENAME="${INPUT%.*}"
OUTPUT="${BASENAME}.pdf"

echo "➡️  Erzeuge PDF (Pandoc → wkhtmltopdf)…"

pandoc "$INPUT" \
  --pdf-engine=wkhtmltopdf \
  --from markdown \
  -o "$OUTPUT"

echo "✅ Fertig: $OUTPUT"
